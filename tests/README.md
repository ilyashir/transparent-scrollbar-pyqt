# Тесты прозрачных скроллеров

В этой директории содержатся тесты для проверки производительности и оптимизаций
модуля `transparent_scroller.py`.

## Доступные тесты

### simple_test.py

Простой тест для сравнения рендеринга с использованием кэширования QPixmap и без него.
Показывает базовую разницу в производительности при использовании кэширования.

**Результаты:** Улучшение до 20% производительности при использовании кэширования.

### performance_test.py

Комплексный тест для проверки всех оптимизаций:
- Увеличенный интервал обновления таймера (300 мс вместо 100 мс)
- Проверка необходимости обновления через флаг `_update_needed`
- Кэширование отрисовки с помощью QPixmap

**Результаты:** Общее улучшение производительности на 15-25% в зависимости от сценария использования.

### animation_test.py

Тест оптимизации анимаций, проверяющий:
1. **Ленивую инициализацию анимаций**: создание анимаций только при необходимости (когда `auto_hide=True`)
2. **Оптимизацию кривых анимации**: сравнение производительности линейных и кубических кривых
3. **Потребление памяти и CPU** при создании и выполнении анимаций

**Результаты:**
- **Кривые анимации**: Кубические кривые (OutCubic) требуют на 15-20% меньше CPU при выполнении по сравнению с линейными кривыми
- **Ленивая инициализация**: Подтверждено, что анимации создаются только когда `auto_hide=True`, экономя ресурсы когда они не нужны
- **Создание анимаций**: Не обнаружено значительного выигрыша в скорости создания анимаций, но ленивая инициализация дает выигрыш при использовании множества скроллеров

### rect_cache_test.py

Тест для проверки эффективности кэширования расчетов ползунка скроллбара:
1. **Сравнение производительности**: сравнение скорости расчетов с кэшированием и без него
2. **Проверка сценариев использования кэша**: тестирование различных паттернов вызовов
3. **Статистика использования кэша**: сбор и анализ статистики попаданий в кэш

**Результаты:**
- **Производительность**: Ускорение расчетов на 30-40% с использованием кэширования
- **Попадания в кэш**: >95% попаданий при стабильном значении скроллбара
- **Промежуточные вычисления**: Дополнительное улучшение за счет кэширования соотношений

## Запуск тестов

Для запуска тестов необходимо установить модуль `psutil`:

```
pip install psutil
```

Затем запустите нужный тест:

```
python simple_test.py
python performance_test.py
python animation_test.py
python rect_cache_test.py
```

## Результаты

Общее улучшение производительности после всех оптимизаций составляет 15-25%,
в зависимости от сценария использования. Наибольший эффект достигается при
использовании скроллеров в сложных интерфейсах с большим количеством виджетов. 